{% extends "stears/writers_base_test.html" %}
{% load stears_tags %}
{% block page_title_block %}
{% endblock %}
{% block nav_block %}
	{% include 'stears/writers_nav.html' %}
{% endblock %}
{% block writers_block %}
	<br>
	<br>
	{% if article.writer %}
		{% if user.username|can_write:article %}
			<div class="row">
				<div class="columns small-10">
					<dl class="accordion" data-accordion>
						<dd class="accordion-navigation">
						<a href="#panel1" class="shadowbox article_box" style="display:inline-block;background-color:white;">
							<strong>
							Write/Edit this article?
							</strong>
						</a>
						<div id="panel1" class="content">
							{% include 'stears/write_form.html' %}
						</div>
						</dd>
					</dl>
				</div>
			</div>
		{% endif %}
	{% else %}
		<div class="row">
			<div class="columns small-10">
				<dl class="accordion" data-accordion>
					<dd class="accordion-navigation">
					<a href="#panel1" class="shadowbox">
						<strong>
						Write this article?
						</strong>
					</a>
					<div id="panel1" class="content" >
						{% include 'stears/write_form.html' %}
					</div>
					</dd>
				</dl>
			</div>
		</div>
		{% include "stears/nse_versions.html" %}
	{% endif %}
	<hr>
	<div class="row">
		<div class="columns small-12 medium-10">
			<div>
				<table>
					<tr>
						<td>
							Headline
						</td>
						<td>
							{{ article.headline }}
						</td>
					</tr>
					{% if article.writer %}
						<tr>
							<td>
								related NSE article
							</td>
							<td>
								{% if article.nse_article_id != '0' %}
									<a href="{% url 'stears:article_detail' pk=article.nse_article_id %}">{{ article.nse_article_id|get_headline }}</a>
								{% else %}
									No related nse data point
								{% endif %}
							</td>
						</tr>
					{% endif %}
					<tr>
						<td>
							Content
						</td>
						<td>
							{{ article.content|linebreaks }}
						</td>
					</tr>
					<tr>
						<td>
							Category
						</td>
						<td>
							{{ article.category }}
						</td>
					</tr>
					<tr>
						<td>
							Writer
						</td>
						<td>
							{% if article.writer %}
								{% if user.username|is_editor %}
									<a href="{% url 'stears:writer_detail' article.writer %}">
										{{ article.writer }}
									</a>
								{% else %}
									{{ article.writer }}
								{% endif %}
							{% endif %}
						</td>
					</tr>
					<tr>
						<td>
							Status
						</td>
						<td>
							<strong>
							{{ article.state }}
							</strong>
						</td>
					</tr>
				</table>
			</div>
		</div>
		<div class="columns small-12 medium-2">
			{% if user.username|is_editor %}
				{% if article.writer %}
					<div class="row">
						<form action="{% url 'stears:delete_article' %}" method="post" id="delete">
							{% csrf_token %}
							<button type="submit" name="article_id" value="{{ article.article_id }}">Delete</button>
						</form>
					</div>
				{% endif%}
			{% endif %}
			{% if user.username|can_suggest:article %}
				<div class="row">
					<form action="{% url 'stears:suggest_nse_article' %}" method="post" id="assign">
						{% csrf_token %}
						{{ suggest_form }}
						<button type="submit" name="article_id" value="{{ article.article_id }}">Suggest</button>
					</form>
				</div>
			{% endif %}
			{% if user.username|is_editor %}
				{% ifequal article.state 'submitted' %}
					<div class="row">
						<form action="{% url 'stears:approve_article' %}" method="post" id="approve">
							{% csrf_token %}
							<button type="submit" name="commit_id" value="{{ article.article_id }}">Approve</button>
						</form>
					</div>
					<div class="row">
						<form action="{% url 'stears:approve_article' %}" method="post" id="reject">
							{% csrf_token %}
							<button type="submit" name="reject_id" value="{{ article.article_id }}">Reject</button>
						</form>
					</div>
				{% endifequal %}
				{% ifequal article.visible False %}
					<div class="row">
						<p>
						<strong>
						{{ article.writer }} can write this article as {{ article.category }}?
						</strong>
						</p>
					</div>
					<div class="row">
						<div class="columns small-6">
							<form action="{% url 'stears:accept_article' %}" method="post" id="accept">
								{% csrf_token %}
								<button type="submit" name="accept_id" value="{{ article.article_id }}">Yes</button>
							</form>
						</div>
						<div class="columns small-6">
							<form action="{% url 'stears:accept_article' %}" method="post" id="accept">
								{% csrf_token %}
								<button type="submit" name="not_accept_id" value="{{ article.article_id }}">No</button>
							</form>
						</div>
					</div>
				{% endifequal %}
			{% endif %}
			<!-- 			{% ifnotequal article.state 'submitted' %}
					{% if user.username|can_write:article %}
							{% ifequal article.writer user.username %}
									<div class="row">
											{% if writers_article_form %}
													<form method="POST" action="{% url 'stears:post' %}">
															{% csrf_token %}
															<div hidden>
																	{{ writers_article_form }}
															</div>
															<button class="confirm-submission" type="submit" name="submit" value="submit" style="padding:15px;">Post article</button>
													</form>
											{% endif %}
									</div>
							{% endifequal %}
					{% endif %}
			{% endifnotequal %} -->
		</div>
	</div>
	
{% endblock %}